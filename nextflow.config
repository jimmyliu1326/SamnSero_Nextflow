manifest {
    author = "Jimmy Liu"
    version = "v2.0.0"
    name = "SamnSero"
    homePage = 'https://github.com/jimmyliu1326/SamnSero_Nextflow'
    description = 'Bacterial Genomics Workflow for Infectious Disease Diagnostics and Surveillance'
    mainScript = "main.nf"
    nextflowVersion = ">=21.0.0"
    manifest.defaultBranch = "main"
}

params {
    input = null
    out_dir = './results'
    watchdir = null
    help = null
    qc = false
    annot = null
    trim = null
    nanohq = null
    gpu = null
    version = null
    centrifuge = "/mnt/e/data/reference/centrifuge/"
    noreport = null
    taxon_name = "Salmonella enterica"
    taxon_level = "species"
    medaka_batchsize = 100
    meta = "off"
    min_binsize = 2000000
    seq_platform = 'nanopore'
    account = null
    disable_binning = null
    lca_rank = 'genus'
    mmseqs_db = "/mnt/e/data/reference/mmseqs2_bacteria"
}

process {
    withLabel:process_low {
        cpus = { 4 }
        memory = { 8.GB }
        time = { 2.h }
    }
    withLabel:process_medium {
        cpus = { 16 }
        memory = { 16.GB }
        time = { 18.h }
    }
    withLabel:process_high {
        cpus = { 32 }
        memory = { 32.GB }
        time = { 36.h }
    }
}

// profile definitions
profiles {

    standard {
        includeConfig 'conf/docker.config'
    }

    slurm {
        includeConfig 'conf/slurm.config'
    }

    singularity {
        includeConfig 'conf/singularity.config'
    }

    docker {
        includeConfig 'conf/docker.config'
    }

    monod {
        includeConfig 'conf/docker.config'
        includeConfig 'conf/slurm.config'
        includeConfig 'conf/monod.config'
    }
}

// override module default parameters/specifications
includeConfig 'conf/modules.config'
includeConfig 'conf/resources.config'

// Export these variables to prevent local Python/R libraries from conflicting with those in the container
env {
    PYTHONNOUSERSITE = 1
    R_PROFILE_USER   = "/.Rprofile"
    R_ENVIRON_USER   = "/.Renviron"
    JULIA_DEPOT_PATH = "/usr/local/share/julia"
}

// Trace pipeline execution metrics
timeline {
    enabled = true
    file    = "${params.out_dir}/pipeline_info/execution_timeline.html"
    overwrite = true
}
report {
    enabled = true
    file    = "${params.out_dir}/pipeline_info/execution_report.html"
    overwrite = true
}
trace {
    enabled = true
    file    = "${params.out_dir}/pipeline_info/execution_trace.txt"
    overwrite = true
}
dag {
    enabled = true
    file    = "${params.out_dir}/pipeline_info/pipeline_dag.html"
    overwrite = true
}